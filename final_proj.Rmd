---
title: "Final Project"
author: "Miroslav Bergam"
date: "10/29/2019"
output: html_document
---

```{r setup, include=FALSE, messages = FALSE, warnings = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
```

```{r Number of Donations}

data <- read_csv("schedule_a-2019-10-29T12_07_33.csv") %>%
  select(committee_name, contributor_name, 
         contributor_employer, 
         contributor_occupation, 
         contributor_first_name, 
         contributor_last_name, 
         contribution_receipt_amount, 
         contribution_receipt_date) %>%
  filter(committee_name != "") %>%
  filter(contributor_occupation != "STUDENT") %>%
  filter(contributor_occupation != "GRADUATE STUDENT") %>%
  mutate(committee_name=dplyr::recode(committee_name,
                `AMY FOR AMERICA` = "Amy Klobuchar",
                `BENNET FOR AMERICA` = "Michael Bennet",
                `BERNIE 2020` = "Bernie Sanders",
                `BETO FOR AMERICA` = "Beto O'Rourke",
                `BIDEN FOR PRESIDENT` = "Joe Biden",
                `BULLOCK FOR PRESIDENT` = "Steve Bullock",
                `CORY 2020` = "Cory Booker",
                `DONALD J. TRUMP FOR PRESIDENT, INC.` = "Donald Trump",
                `FRIENDS OF ANDREW YANG` = "Andrew Yang",
                `FRIENDS OF JOHN DELANEY` = "John Delaney",
                `GILLIBRAND 2020` = "Kirstan Gillibrand",
                `HICKENLOOPER 2020` = "John Hickenlooper",
                `INSLEE FOR AMERICA` = "Jay Inslee",
                `JULIAN FOR THE FUTURE` = "Julian Castro",
                `KAMALA HARRIS FOR THE PEOPLE` = "Kamala Harris",
                `PETE FOR AMERICA, INC.` = "Pete Buttigieg",
                `SETH MOULTON FOR AMERICA, INC.` = "Seth Moulton",
                `SWALWELL FOR AMERICA` = "Eric Swalwell",
                `TOM STEYER 2020` = "Tom Steyer",
                `TULSI NOW` = "Tulsi Gabbard",
                `WARREN FOR PRESIDENT, INC.` = "Elizabeth Warren",
                `WALSH FOR PRESIDENT` = "Joe Walsh",
                `WELD 2020 PRESIDENTIAL CAMPAIGN COMMITTEE, INC.` = "Bill Weld"))

ggplot(data, aes(x = committee_name, fill = committee_name)) +
  geom_bar() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") + 
  labs(title = "Harvard Political Donations to 2020 Presidential Campaigns",
       subtitle = "Donations of Individuals Employed by Harvard University",
       x = "Presidential  Campaigns",
       y = "Number of Individual Donations")

```

```{r Unique Donors}

num_donors <- data %>%
  group_by(committee_name, contributor_name) %>%
  slice(1) %>%
  ungroup() %>%
  group_by(committee_name) %>%
  summarise(num_donors = n())

ggplot(num_donors, aes(x = reorder(committee_name, num_donors), y = num_donors, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Political Donors to 2020 Presidential Campaigns",
       subtitle = "Individuals Employed by Harvard University",
       x = "Presidential Campaigns",
       y = "Number of Donors")

```

```{r Amount Donated}

amount_graph <- data %>%
  group_by(committee_name) %>%
  summarise(total_donations = sum(contribution_receipt_amount)) %>%
  mutate(total_donations = as.numeric(total_donations))

ggplot(amount_graph, aes(x = reorder(committee_name, total_donations), y = total_donations, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Employees' Total Donations to 2020 Presidential Campaigns",
       subtitle = "Donations by Individuals Employed by Harvard University",
       x = "Presidential Campaigns",
       y = "Dollars")

```

```{r Mean Donation}

amount_graph <- data %>%
  group_by(committee_name) %>%
  summarise(mean_donations = mean(contribution_receipt_amount)) %>%
  mutate(mean_donations = as.numeric(mean_donations))

ggplot(amount_graph, aes(x = reorder(committee_name, mean_donations), y = mean_donations, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Employees' Mean Donations to 2020 Presidential Campaigns",
       subtitle = "Donations by Individuals Employed by Harvard University",
       x = "Presidential Campaigns",
       y = "Dollars")

```

```{r By Employer}

by_employer <- data %>%
  filter(contributor_employer == "HARVARD UNIVERSITY" |  
           contributor_employer == "HARVARD"  | 
           contributor_employer == "HARVARD KENNEDY SCHOOL"  | 
           contributor_employer == "HARVARD LAW SCHOOL" | 
           contributor_employer == "HARVARD BUSINESS SCHOOL" | 
           contributor_employer == "HARVARD SCHOOL OF PUBLIC HEALTH") %>%
  group_by(contributor_employer) %>%
  summarise(total_donations = sum(contribution_receipt_amount)) %>%
  mutate(total_donations = as.numeric(total_donations))

ggplot(by_employer, aes(x = contributor_employer, y = total_donations, fill = contributor_employer)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none")

```

```{r}

by_employer_facet <- data %>%
  filter(contributor_employer == "HARVARD KENNEDY SCHOOL"  | 
           contributor_employer == "HARVARD LAW SCHOOL" | 
           contributor_employer == "HARVARD BUSINESS SCHOOL" | 
           contributor_employer == "HARVARD SCHOOL OF PUBLIC HEALTH" |
           contributor_employer == "HARVARD GRADUATE SCHOOL OF EDUCATION")

employer_piechart <- by_employer_facet %>%
  group_by(contributor_employer) %>%
  summarise(num_donors = n()) 

#ggplot(employer_piechart, aes(x = "",y = num_donors, fill = contributor_employer)) +
#  geom_bar(stat="identity", width=1) + 
#  coord_polar("y", start=0)

#employer_piechart_money <- by_employer_facet %>%
#  group_by(contributor_employer) %>%
#  summarise(money = sum(contribution_receipt_amount)) %>%

#ggplot(employer_piechart_money, aes(x = "", y = money, fill = contributor_employer)) +
#  geom_bar(stat="identity", width=1) + 
#  coord_polar("y", start=0)


ggplot(by_employer_facet, aes(x = committee_name, fill = committee_name)) +
  geom_bar() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") + 
  facet_wrap(~ contributor_employer) #+ 
  #coord_polar("y", start=0)

```

