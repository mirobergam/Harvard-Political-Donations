---
title: "Final Project"
author: "Miroslav Bergam"
date: "10/29/2019"
output: html_document
---

```{r setup, include=FALSE, messages = FALSE, warnings = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
```

```{r Number of Donations}

data <- read_csv("MOREDATA.csv") %>%
  select(committee_name, contributor_name, 
         contributor_employer, 
         contributor_occupation, 
         contributor_first_name, 
         contributor_last_name, 
         contribution_receipt_amount, 
         contribution_receipt_date) %>%
  filter(committee_name != "") %>%
  filter(contributor_occupation != "STUDENT") %>%
  filter(contributor_occupation != "GRADUATE STUDENT") %>%
  filter(contributor_employer != "HARVARD-WESTLAKE SCHOOL") %>%
  filter(committee_name != "DEMOCRATS WORK FOR AMERICA, INC") %>%
  filter(committee_name != "BLACK PAC") %>%
  filter(committee_name != "FORWARD MAJORITY ACTION") %>%
  filter(committee_name != "MIND THE GAP") %>%
  filter(committee_name != "NEED TO IMPEACH") %>%
  filter(committee_name != "UNITE AMERICA CONGRESSIONAL ELECTION FUND") %>%
  filter(committee_name != "WYOMING STRONG ACTION") %>%
  filter(committee_name != "LCV VICTORY FUND") %>%
  filter(committee_name != "WITH HONOR FUND, INC.") %>%
  filter(committee_name != "JOE SESTAK FOR PRESIDENT") %>%
  filter(committee_name != "SMP") %>%
  filter(committee_name != "HOUSE MAJORITY PAC") %>%
  mutate(committee_name=dplyr::recode(committee_name,
                `AMY FOR AMERICA` = "Amy Klobuchar",
                `BENNET FOR AMERICA` = "Michael Bennet",
                `BERNIE 2020` = "Bernie Sanders",
                `BETO FOR AMERICA` = "Beto O'Rourke",
                `BIDEN FOR PRESIDENT` = "Joe Biden",
                `BULLOCK FOR PRESIDENT` = "Steve Bullock",
                `CORY 2020` = "Cory Booker",
                `DONALD J. TRUMP FOR PRESIDENT, INC.` = "Donald Trump",
                `FRIENDS OF ANDREW YANG` = "Andrew Yang",
                `FRIENDS OF JOHN DELANEY` = "John Delaney",
                `GILLIBRAND 2020` = "Kirstan Gillibrand",
                `HICKENLOOPER 2020` = "John Hickenlooper",
                `INSLEE FOR AMERICA` = "Jay Inslee",
                `JULIAN FOR THE FUTURE` = "Julian Castro",
                `KAMALA HARRIS FOR THE PEOPLE` = "Kamala Harris",
                `PETE FOR AMERICA, INC.` = "Pete Buttigieg",
                `SETH MOULTON FOR AMERICA, INC.` = "Seth Moulton",
                `SWALWELL FOR AMERICA` = "Eric Swalwell",
                `TOM STEYER 2020` = "Tom Steyer",
                `TULSI NOW` = "Tulsi Gabbard",
                `WARREN FOR PRESIDENT, INC.` = "Elizabeth Warren",
                `WALSH FOR PRESIDENT` = "Joe Walsh",
                `WELD 2020 PRESIDENTIAL CAMPAIGN COMMITTEE, INC.` = "Bill Weld"))

number_donations <- data %>%
  group_by(committee_name) %>%
  summarise(num_donations = n()) %>%
  mutate(num_donations = as.numeric(num_donations))


ggplot(number_donations, aes(x = reorder(committee_name, num_donations), y = num_donations, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") + 
  labs(title = "Harvard Political Donations to 2020 Presidential Campaigns",
       subtitle = "Donations of Individuals Employed by Harvard University",
       x = "Presidential  Campaigns",
       y = "Number of Individual Donations")

```

```{r Unique Donors}

num_donors <- data %>%
  group_by(committee_name, contributor_name) %>%
  slice(1) %>%
  ungroup() %>%
  group_by(committee_name) %>%
  summarise(num_donors = n())

ggplot(num_donors, aes(x = reorder(committee_name, num_donors), y = num_donors, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Political Donors to 2020 Presidential Campaigns",
       subtitle = "Individuals Employed by Harvard University",
       x = "Presidential Campaigns",
       y = "Number of Donors")

```

```{r Amount Donated}

amount_graph <- data %>%
  group_by(committee_name) %>%
  summarise(total_donations = sum(contribution_receipt_amount)) %>%
  mutate(total_donations = as.numeric(total_donations))

ggplot(amount_graph, aes(x = reorder(committee_name, total_donations), y = total_donations, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Employees' Total Donations to 2020 Presidential Campaigns",
       subtitle = "Donations by Individuals Employed by Harvard University",
       x = "Presidential Campaigns",
       y = "Dollars")

```

```{r Mean Donation}

amount_graph <- data %>%
  group_by(committee_name) %>%
  summarise(mean_donations = mean(contribution_receipt_amount)) %>%
  mutate(mean_donations = as.numeric(mean_donations))

ggplot(amount_graph, aes(x = reorder(committee_name, mean_donations), y = mean_donations, fill = committee_name)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Employees' Mean Donations to 2020 Presidential Campaigns",
       subtitle = "Donations by Individuals Employed by Harvard University",
       x = "Presidential Campaigns",
       y = "Dollars")

```

```{r By Employer}

by_employer <- data %>%
  filter(contributor_employer == "HARVARD KENNEDY SCHOOL"  | 
           contributor_employer == "HARVARD LAW SCHOOL" | 
           contributor_employer == "HARVARD BUSINESS SCHOOL" | 
           contributor_employer == "HARVARD SCHOOL OF PUBLIC HEALTH" |
           contributor_employer == "HARVARD GRADUATE SCHOOL OF ARTS AND SCIENCES" |
           contributor_employer == "HARVARD GRADUATE SCHOOL OF EDUCATION" |
           contributor_employer == "HARVARD DIVINITY SCHOOL")

by_employer_sum <- by_employer %>%  
  group_by(contributor_employer) %>%
  summarise(total_donations = sum(contribution_receipt_amount)) %>%
  mutate(total_donations = as.numeric(total_donations))

ggplot(by_employer_sum, aes(x = reorder(contributor_employer, total_donations), y = total_donations, fill = contributor_employer)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Grad School Employees' Total Donations to 2020 Pres. Campaigns",
       subtitle = "Donations by Individuals Employed by Graduate Schools",
       x = "Graduate Schools",
       y = "Dollars")

by_employer_mean <- by_employer %>%  
  group_by(contributor_employer) %>%
  summarise(total_donations = mean(contribution_receipt_amount)) %>%
  mutate(total_donations = as.numeric(total_donations))

ggplot(by_employer_mean, aes(x = reorder(contributor_employer, total_donations), y = total_donations, fill = contributor_employer)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") +
  labs(title = "Harvard Grad School Employees' Mean Donations to 2020 Pres. Campaigns",
       subtitle = "Donations by Individuals Employed by Graduate Schools",
       x = "Graduate Schools",
       y = "Dollars")
```

```{r}

by_employer_facet <- data %>%
  filter(contributor_employer == "HARVARD KENNEDY SCHOOL"  | 
           contributor_employer == "HARVARD LAW SCHOOL" | 
           contributor_employer == "HARVARD BUSINESS SCHOOL" | 
           contributor_employer == "HARVARD SCHOOL OF PUBLIC HEALTH" |
           contributor_employer == "HARVARD GRADUATE SCHOOL OF EDUCATION")

ggplot(by_employer_facet, aes(x = committee_name, fill = committee_name)) +
  geom_bar() + 
  theme(axis.text.x = element_text(angle = 90)) + 
  theme(legend.position = "none") + 
  facet_wrap(~ contributor_employer) +
  labs(y = "Number of Donations",
       x = "Candidate")

employer_piechart <- by_employer_facet %>%
  group_by(contributor_employer) %>%
  summarise(num_donors = n()) 

#ggplot(employer_piechart, aes(x = "",y = num_donors, fill = contributor_employer)) +
#  geom_bar(stat="identity", width=1) + 
#  coord_polar("y", start=0)

#employer_piechart_money <- by_employer_facet %>%
#  group_by(contributor_employer) %>%
#  summarise(money = sum(contribution_receipt_amount)) %>%

#ggplot(employer_piechart_money, aes(x = "", y = money, fill = contributor_employer)) +
#  geom_bar(stat="identity", width=1) + 
#  coord_polar("y", start=0)


```

